# =========================
# ğŸ—ï¸ Giai Ä‘oáº¡n 1: Build app báº±ng Maven
# =========================
FROM maven:3.9.9-eclipse-temurin-17 AS build
WORKDIR /app

# Sao chÃ©p toÃ n bá»™ mÃ£ nguá»“n vÃ o container
COPY demo /app

# Build project vÃ  bá» qua test
RUN mvn -f /app/pom.xml clean package -DskipTests


# =========================
# ğŸš€ Giai Ä‘oáº¡n 2: Cháº¡y á»©ng dá»¥ng (khÃ´ng dÃ¹ng Alpine)
# =========================
FROM eclipse-temurin:17-jdk
WORKDIR /app

# Copy file JAR tá»« stage build sang
COPY --from=build /app/target/*.jar app.jar

# Má»Ÿ cá»•ng 8080
EXPOSE 8080

# âœ… Lá»‡nh khá»Ÿi cháº¡y á»©ng dá»¥ng
ENTRYPOINT ["java", "-jar", "app.jar"]
